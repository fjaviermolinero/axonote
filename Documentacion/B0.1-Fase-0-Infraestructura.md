# B0.1 - Fase 0: Infraestructura del Proyecto Axonote

## ğŸ“‹ Resumen de la Fase

La **Fase 0** establece los cimientos del proyecto Axonote, creando toda la infraestructura necesaria para el desarrollo, testing y despliegue de la plataforma PWA de transcripciÃ³n mÃ©dica.

### âœ… Objetivos Completados

1. **Estructura de proyecto** siguiendo arquitectura modular
2. **Docker Compose** para desarrollo local
3. **ConfiguraciÃ³n de herramientas** (linting, formatting, testing)
4. **Archivos de configuraciÃ³n** para ambos stacks (Python + TypeScript)
5. **Makefile** con comandos de desarrollo optimizados
6. **DocumentaciÃ³n base** con instrucciones completas

## ğŸ—ï¸ Arquitectura Implementada

### **Estructura de Directorios**
```
axonote/
â”œâ”€ apps/
â”‚  â”œâ”€ api/                  # Backend FastAPI
â”‚  â”‚  â”œâ”€ app/              # CÃ³digo fuente principal
â”‚  â”‚  â”‚  â”œâ”€ api/           # Routers REST API
â”‚  â”‚  â”‚  â”œâ”€ core/          # Config, seguridad, logging
â”‚  â”‚  â”‚  â”œâ”€ models/        # Modelos SQLAlchemy
â”‚  â”‚  â”‚  â”œâ”€ schemas/       # Esquemas Pydantic
â”‚  â”‚  â”‚  â”œâ”€ services/      # Servicios (MinIO, Notion, LLM, etc.)
â”‚  â”‚  â”‚  â”œâ”€ tasks/         # Tareas Celery para procesamiento
â”‚  â”‚  â”‚  â””â”€ workers/       # Workers Celery
â”‚  â”‚  â”œâ”€ alembic/          # Migraciones de base de datos
â”‚  â”‚  â””â”€ pyproject.toml    # Dependencias y configuraciÃ³n Python
â”‚  â””â”€ web/                 # Frontend Next.js PWA
â”‚     â”œâ”€ app/              # Next.js 14 App Router
â”‚     â”œâ”€ components/       # Componentes React reutilizables
â”‚     â”œâ”€ lib/              # Utilidades y cliente API
â”‚     â”œâ”€ public/           # Assets estÃ¡ticos y PWA manifest
â”‚     â”œâ”€ package.json      # Dependencias Node.js
â”‚     â”œâ”€ tailwind.config.ts # ConfiguraciÃ³n Tailwind
â”‚     â””â”€ tsconfig.json     # ConfiguraciÃ³n TypeScript
â”œâ”€ docker/                 # Dockerfiles para cada servicio
â”‚  â”œâ”€ api.Dockerfile       # Contenedor FastAPI
â”‚  â”œâ”€ worker.Dockerfile    # Contenedor Celery Worker
â”‚  â””â”€ web.Dockerfile       # Contenedor Next.js
â”œâ”€ deploy/                 # Archivos de despliegue
â”œâ”€ scripts/                # Scripts de utilidad
â”œâ”€ Documentacion/          # DocumentaciÃ³n tÃ©cnica con etiquetas
â”‚  â””â”€ B0.1-Fase-0-Infraestructura.md
â”œâ”€ .gitignore             # Exclusiones Git
â”œâ”€ .editorconfig          # ConfiguraciÃ³n editor
â”œâ”€ docker-compose.dev.yml # Servicios para desarrollo
â”œâ”€ env.example            # Variables de entorno ejemplo
â”œâ”€ Makefile              # Comandos de desarrollo
â””â”€ README.md             # DocumentaciÃ³n principal
```

## ğŸ³ Servicios Docker

### **docker-compose.dev.yml**
- **PostgreSQL 15**: Base de datos principal con healthchecks
- **Redis 7**: Broker para Celery y cachÃ©
- **MinIO**: Almacenamiento de objetos para audio/archivos
- **FastAPI**: Servidor backend con hot-reload
- **Celery Worker**: Procesamiento asÃ­ncrono
- **Next.js**: Frontend PWA con hot-reload

### **ConfiguraciÃ³n de Red**
- Red personalizada `axonote_dev`
- Puertos expuestos: 3000 (web), 8000 (api), 5432 (db), 6379 (redis), 9000/9001 (minio)
- VolÃºmenes persistentes para datos
- Healthchecks para dependencias

## âš™ï¸ ConfiguraciÃ³n de Herramientas

### **Python (Backend)**
**pyproject.toml** configurado con:
- **Poetry** para gestiÃ³n de dependencias
- **FastAPI** + **Uvicorn** para servidor ASGI
- **SQLAlchemy 2.0** + **Alembic** para ORM y migraciones
- **Celery** + **Redis** para tareas asÃ­ncronas
- **Pydantic 2.0** para validaciÃ³n de datos
- **Boto3** + **MinIO** para almacenamiento
- **Notion Client** para integraciÃ³n
- **Tools de desarrollo**: ruff, black, mypy, pytest

**ConfiguraciÃ³n de calidad**:
- **ruff**: Linting rÃ¡pido con reglas estrictas
- **black**: Formateo automÃ¡tico (line-length: 88)
- **mypy**: Type checking estricto
- **pytest**: Tests con coverage â‰¥85%

### **TypeScript (Frontend)**
**package.json** configurado con:
- **Next.js 14** con App Router
- **React 18** + **TypeScript 5**
- **Tailwind CSS** con plugins forms/typography
- **Zustand** para gestiÃ³n de estado
- **IndexedDB** (idb) para almacenamiento offline
- **Axios** para cliente HTTP
- **React Hook Form** + **Zod** para formularios
- **Framer Motion** para animaciones

**ConfiguraciÃ³n de desarrollo**:
- **ESLint**: ConfiguraciÃ³n Airbnb + TypeScript
- **Prettier**: Formateo con plugin Tailwind
- **Jest** + **Testing Library** para unit tests
- **Playwright** para E2E testing

## ğŸ¨ Sistema de DiseÃ±o

### **Tailwind Configuration**
Paleta de colores optimizada para aplicaciones mÃ©dicas:
- **Primary**: Azules profesionales (#3b82f6 family)
- **Secondary**: Verdes mÃ©dicos (#22c55e family)
- **Accent**: Amarillos de alerta (#d97706 family)
- **Gray**: Escala completa para interfaz
- **Semantic**: Success, warning, error

**CaracterÃ­sticas especiales**:
- Fuentes: Inter (sans) + Fira Code (mono)
- Animaciones personalizadas: fade-in, slide-up, recording
- Breakpoints responsive
- Dark mode support
- Componentes mÃ©dicos especÃ­ficos

## ğŸ“ Variables de Entorno

### **ConfiguraciÃ³n Completa (env.example)**
Incluye todas las variables necesarias organizadas por categorÃ­as:

1. **FastAPI**: Puerto, host, CORS, secret key
2. **Database**: PostgreSQL connection string
3. **Redis**: URL para Celery broker/backend
4. **Storage**: MinIO/Nextcloud configuration
5. **Notion**: Token y database IDs
6. **LLM**: Providers (LM Studio, Ollama, OpenAI)
7. **ASR/Diarization**: Whisper + pyannote config
8. **OCR**: Tesseract configuration
9. **TTS**: Piper voices configuration
10. **Feature Flags**: ActivaciÃ³n/desactivaciÃ³n de funcionalidades
11. **Security**: Rate limits, file sizes, allowed formats
12. **Logging**: Nivel, formato, archivos
13. **Medical Sources**: Whitelist de fuentes vÃ¡lidas
14. **Languages**: ConfiguraciÃ³n multiidioma
15. **GPU**: Variables NVIDIA para contenedores

## ğŸ› ï¸ Makefile - Comandos de Desarrollo

### **Comandos Principales**
```bash
# GestiÃ³n de servicios
make up              # Levantar todos los servicios
make down            # Parar servicios
make logs            # Ver logs en tiempo real
make restart         # Reiniciar servicios

# Desarrollo
make format          # Formatear cÃ³digo (Python + TypeScript)
make lint            # Verificar estilo de cÃ³digo
make test            # Ejecutar todos los tests
make dev-setup       # Setup completo automÃ¡tico

# Base de datos
make migrate         # Aplicar migraciones
make migration       # Crear nueva migraciÃ³n
make db-reset        # Reset completo (âš ï¸ elimina datos)

# Utilidades
make shell-api       # Shell en contenedor API
make shell-db        # ConexiÃ³n a PostgreSQL
make health          # Verificar salud de servicios
make clean           # Limpiar contenedores no utilizados
```

### **Workflow de Desarrollo**
1. `make dev-setup` - Setup inicial completo
2. `make format` - Antes de commits
3. `make test` - Verificar calidad
4. `make health` - Verificar servicios

## ğŸ”§ Dockerfiles Optimizados

### **api.Dockerfile**
- **Base**: Python 3.11-slim
- **Multi-stage**: Optimizado para desarrollo/producciÃ³n
- **Security**: Usuario no-root
- **Dependencies**: Poetry para gestiÃ³n
- **Health**: Endpoint de salud

### **worker.Dockerfile**
- **Base**: Python 3.11-slim
- **Additional**: FFmpeg para procesamiento audio
- **Same patterns**: Consistencia con API
- **Celery**: ConfiguraciÃ³n especÃ­fica

### **web.Dockerfile**
- **Base**: Node 18-alpine
- **Optimization**: npm ci para instalaciÃ³n rÃ¡pida
- **Security**: Usuario nodejs no-root
- **Development**: Hot-reload support

## ğŸ“š DocumentaciÃ³n TÃ©cnica

### **ConvenciÃ³n de Etiquetas**
- `B0.1` â†’ Backend, Fase 0, documento 1
- PrÃ³ximos ejemplos:
  - `B1.1` â†’ Backend, Fase 1, documento 1
  - `A2.3` â†’ App (frontend), Fase 2, documento 3

### **README.md Completo**
- DescripciÃ³n tÃ©cnica detallada
- GuÃ­as de instalaciÃ³n step-by-step
- Troubleshooting comÃºn
- Arquitectura y tecnologÃ­as
- Roadmap de desarrollo

## âœ… Checklist de ValidaciÃ³n

### **Estructura de Proyecto**
- [x] Directorios creados segÃºn especificaciÃ³n
- [x] SeparaciÃ³n clara backend/frontend
- [x] Estructura Docker organizada
- [x] Scripts y documentaciÃ³n ubicados

### **ConfiguraciÃ³n de Desarrollo**
- [x] pyproject.toml con todas las dependencias
- [x] package.json con stack Next.js completo
- [x] Tailwind configurado para aplicaciÃ³n mÃ©dica
- [x] TypeScript con configuraciÃ³n estricta
- [x] Linting y formatting tools configurados

### **Docker Infrastructure**
- [x] docker-compose.dev.yml functional
- [x] Servicios con healthchecks
- [x] VolÃºmenes para persistencia
- [x] Network configuration
- [x] Environment variables setup

### **Development Tools**
- [x] Makefile con comandos esenciales
- [x] Git configuration (.gitignore, .editorconfig)
- [x] Variables de entorno documentadas
- [x] README con instrucciones completas

## ğŸš€ PrÃ³ximos Pasos - Fase 1

Con la infraestructura completa, la **Fase 1** implementarÃ¡:

1. **FastAPI Backend Base**
   - main.py con routers bÃ¡sicos
   - Sistema de configuraciÃ³n con Pydantic Settings
   - Middlewares de seguridad y logging
   - Endpoints de salud y settings

2. **Base de Datos**
   - Modelos SQLAlchemy (ClassSession, Professor, etc.)
   - Migraciones Alembic iniciales
   - Repositorios y servicios base

3. **Celery Integration**
   - Workers bÃ¡sicos
   - Tareas dummy para testing
   - MonitorizaciÃ³n con Flower (opcional)

4. **Services Layer**
   - Servicio MinIO para storage
   - Servicio Notion bÃ¡sico
   - Stubs para LLM, ASR, OCR, TTS

## ğŸ“Š MÃ©tricas de la Fase 0

- **Archivos creados**: 15+ archivos de configuraciÃ³n
- **Lines of code**: ~2000 lÃ­neas (config + docs)
- **Services configured**: 6 servicios Docker
- **Dependencies**: 40+ Python packages, 25+ Node packages
- **Make targets**: 20+ comandos de desarrollo
- **Documentation**: README + documentaciÃ³n tÃ©cnica

---

**Estado**: âœ… **Completado**  
**Siguiente**: Fase 1 - Backend Base (FastAPI + DB + Celery)  
**Tiempo estimado Fase 1**: 2-3 dÃ­as de desarrollo
